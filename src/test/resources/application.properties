# Archivo de propiedades para los tests (se carga desde src/test/resources)
# Configura la conexión a MySQL usada por las pruebas de integración.

# URL JDBC: formato jdbc:mysql://<host>:<puerto>/<base_datos>
# - localhost:3308 -> supone que el contenedor MySQL mapea el puerto 3306 del contenedor al 3308 del host
# - springbootdb -> nombre de la base de datos (debe existir o el usuario necesitará permisos para crearla)
# - useSSL=false -> desactiva SSL en entornos locales
# - serverTimezone=UTC -> evita errores por zona horaria
# - allowPublicKeyRetrieval=true -> ayuda con la autenticación en MySQL 8 en entornos locales
spring.datasource.url=jdbc:mysql://localhost:3308/springbootdb?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=password
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect

# Estrategia DDL para tests:
# create-drop -> crea las tablas al iniciar el contexto y las borra al finalizar.
# Útil para tests porque deja la BD en estado limpio, pero requiere que la base de datos exista.
spring.jpa.hibernate.ddl-auto=create-drop

# Opciones DDL posibles:
#none / validate: no cambia el esquema (validate solo comprueba).
#create: crea las tablas al iniciar, no las borra al cerrar (datos persisten).
#update: intenta ajustar el esquema sin borrar tablas; conserva datos (riesgos al cambiar entidades).
#create-drop: crea al iniciar y borra al finalizar (ideal para tests aislados, no para entornos con datos permanentes).

spring.jpa.show-sql=true

# Ejecutar scripts SQL de inicialización (data.sql) si existen en recursos de test
spring.jpa.defer-datasource-initialization=true
spring.sql.init.mode=always

# Configuración del pool Hikari (tiempos y tamaño razonables para tests locales)
# connection-timeout en ms: cuánto esperar por una conexión antes de fallar
spring.datasource.hikari.connection-timeout=30000
# máximo de conexiones en el pool
spring.datasource.hikari.maximum-pool-size=5
